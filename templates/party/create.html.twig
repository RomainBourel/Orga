{% extends 'base.html.twig' %}

{% block title %}{{ parent() }}-cr√©ation{% endblock %}

{% block javascripts %}
    {{ parent() }}
    {{ encore_entry_script_tags('party_form') }}
{% endblock %}

{% block body %}
    <div class="section__title">
        <h1 class="title">{{ 'form.party.title'|trans }}</h1>
    </div>

    {{ form_start(form) }}
    {{ form_errors(form) }}
    <div class="form__section">
        {{ form_row(form.name) }}
        {{ form_row(form.description) }}
    </div>
    <div class="form__section">
        {{ form_row(form.location) }}
    </div>

    <div class="form__section">
        {% for date in form.propositionDates %}
            {{ form_widget(date) }}
        {% endfor %}
        <div id="proposition-date-list" data-template='{{ form_widget(form.propositionDates.vars.prototype)|raw }}'></div>
        <button
                id="add-proposition-date"
                class="btn btn__primary"
                type="button"
                data-add-proposition-text="{{ 'form.party.button.add_proposition_date'|trans }}"
                data-listener="false"
        >
            {{ 'form.party.button.make_proposition'|trans }}
        </button>
    </div>

    <div class="form__section d-flex flex-column align-items-center">
        <input
                id="search-product"
                placeholder="{{ 'form.party.placeholder.search_product'|trans }}"
                class="form-control"
                name="search-product"
                type="text"
                data-url="{{ path('product_search') }}"
                list="search-list"
        />
        <div id="product-proposition-table"></div>
        <button
            id="add-product"
            class="btn btn__primary"
            type="button"
            data-url="{{ path('product_create') }}"
            data-template='{{ form_widget(form.product.vars.prototype)|raw }}'
            data-toggle="modal"
            data-target="#modal"
        >
            {{ 'form.party.button.add_product'|trans }}
        </button>
        <div id="products-list" data-template='{{ form_widget(form.productsParty.vars.prototype)|raw }}'></div>
        {% for productParty in form.productsParty %}
            {{ form_widget(productParty, {
                'attr': {
                    'data-unity':  productParty.vars.value.product.unity.name,
                    'data-name': productParty.vars.value.product.name,
                    'data-id': productParty.vars.value.product.id,
                }
            }) }}
        {% endfor %}
    </div>

    <div class="d-flex flex-column align-items-center">
        <button class="btn-dark btn" type="submit">{{ 'form.party.button.create_party'|trans }}</button>
    </div>
    {{ form_end(form) }}
    <div id="new-product-form" class="modal" data-modal="true" data-url="{{ path('product_create') }}"></div>
    {% include "partials/_modal.html.twig" %}
{% endblock %}
